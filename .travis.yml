language: swift
osx_image: xcode12
notifications:
  email: true
branches:
  only:
    - develop
    - main

env:
  - LC_CTYPE=en_US.UTF-8 LANG=en_US.UTF-8

before_install:
  - gem install cocoapods
  - gem install xcpretty -N
  - make bootstrap
  - make secrets
  - make google-service

jobs:
  include:
    - stage: lint
      script:
        - ./Pods/SwiftLint/swiftlint --reporter junit

    - stage: build
      script:
        - make build

    - stage: test
      script:
        - make test
      after_success:
        - bash <(curl -s https://codecov.io/bash)
